<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TEEL Mission: Two Wolves</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@400;700&display=swap');

        :root {
            --bg-color: #0a0e1a;
            --panel-bg: #1a2332;
            --primary-color: #00ffcc; /* Training Academy Cyan */
            --secondary-color: #ff6b9d; /* Mission Pink */
            --text-color: #e0e0e0;
            --font-heading: 'Orbitron', sans-serif;
            --font-body: 'Roboto', sans-serif;
            --correct-color: #4caf50;
            --incorrect-color: #f44336;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: var(--font-body);
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(0, 255, 204, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 107, 157, 0.1) 0%, transparent 50%);
        }

        .container {
            width: 100%;
            max-width: 800px;
            background-color: var(--panel-bg);
            border: 2px solid var(--primary-color);
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 0 20px rgba(0, 255, 204, 0.3);
        }

        h1, h2 {
            font-family: var(--font-heading);
            text-align: center;
            text-shadow: 0 0 5px;
        }

        h1 {
            font-size: 2.2em;
            margin-top: 0;
            color: var(--primary-color);
        }

        .training h1 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
        }

        .mission h1 {
            color: var(--secondary-color);
            border-bottom: 2px solid var(--secondary-color);
        }

        h2 {
            font-size: 1.6em;
            padding-bottom: 10px;
            margin-top: 30px;
        }

        .training h2 {
            color: var(--primary-color);
        }

        .mission h2 {
            color: var(--secondary-color);
        }

        .intro-text {
            text-align: center;
            font-size: 1em;
        }

        .teel-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .teel-part {
            background-color: rgba(0, 255, 204, 0.05);
            border: 1px solid var(--primary-color);
            padding: 15px;
            border-radius: 5px;
        }

        .teel-part h3 {
            font-family: var(--font-heading);
            color: var(--primary-color);
            margin-top: 0;
            font-size: 1.3em;
        }

        .teel-part p {
            font-size: 0.9em;
        }

        .teel-part .example {
            margin-top: 10px;
            padding: 8px;
            background-color: rgba(0, 255, 204, 0.1);
            border-left: 3px solid var(--primary-color);
            border-radius: 5px;
            font-style: italic;
        }

        .teel-part .common-words {
            font-style: italic;
            font-size: 0.85em;
            background-color: rgba(0, 255, 204, 0.1);
            padding: 5px;
            border-radius: 3px;
            margin-top: 10px;
        }
        
        .mission-section {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
            display: none; /* Hidden by default */
        }

        .mission-section.visible {
            opacity: 1;
            transform: translateY(0);
            display: block;
        }

        .objectives label {
            display: block;
            background-color: rgba(255, 107, 157, 0.1);
            border: 1px solid var(--secondary-color);
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }

        .objectives p {
            font-size: 0.9em;
            margin: 4px 0;
        }

        .lock-box {
            background-color: rgba(255, 255, 255, 0.05);
            border-left: 5px solid var(--secondary-color);
            padding: 20px;
            margin-top: 20px;
            border-radius: 5px;
        }

        .lock-box h3 {
            font-family: var(--font-heading);
            color: var(--secondary-color);
            margin-top: 0;
        }

        .lock-box p, .lock-box li {
            font-size: 0.95em;
        }

        .lock-box ul {
            list-style-type: 'üîπ ';
            padding-left: 20px;
        }

        textarea {
            width: 100%;
            height: 100px;
            background-color: var(--bg-color);
            color: var(--text-color);
            border: 1px solid var(--secondary-color);
            border-radius: 5px;
            padding: 10px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 1em;
            resize: vertical;
        }

        #finalParagraph {
            height: 200px;
            background-color: #000;
            color: #0f0;
            border-color: #0f0;
        }

        button {
            font-family: var(--font-heading);
            background-color: var(--primary-color);
            color: var(--bg-color);
            border: none;
            padding: 10px 22px;
            font-size: 0.9em;
            font-weight: 700;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            margin-top: 15px;
            display: inline-block;
        }

        .mission button.main-btn {
            background-color: var(--secondary-color);
        }

        .button-row {
            text-align: center;
            margin-top: 15px;
        }

        button:hover {
            transform: scale(1.05);
            filter: brightness(1.1);
        }

        button:active {
            transform: scale(0.98);
        }

        button:disabled {
            background-color: #555;
            color: #999;
            cursor: not-allowed;
            transform: scale(1);
        }
        
        .checklist {
            list-style-type: none;
            padding: 0;
        }

        .checklist li {
            margin: 8px 0;
            display: flex;
            align-items: center;
            font-size: 0.9em;
        }

        .checklist input[type="checkbox"] {
            margin-right: 10px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        #congratsMessage {
            text-align: center;
            font-size: 1.3em;
            font-family: var(--font-heading);
            color: var(--secondary-color);
            margin-top: 20px;
            display: none; /* Hidden by default */
        }

        /* --- Matching Game Styles --- */
        .matching-game {
            margin-top: 20px;
            border: 1px dashed var(--primary-color);
            padding: 20px;
            border-radius: 5px;
        }

        .matching-game h3 {
            color: var(--primary-color);
            text-align: center;
            margin-top: 0;
        }

        .game-items {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            gap: 15px;
            margin-bottom: 20px;
        }

        .column {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .game-item {
            background-color: var(--bg-color);
            border: 1px solid var(--primary-color);
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            font-size: 0.9em;
        }

        .game-item:hover:not(.correct):not(.incorrect) {
            background-color: rgba(0, 255, 204, 0.2);
        }

        .game-item.selected {
            background-color: var(--primary-color);
            color: var(--bg-color);
            transform: scale(1.05);
        }

        .game-item.correct {
            background-color: var(--correct-color);
            color: white;
            border-color: var(--correct-color);
            cursor: default;
            transform: scale(1);
        }

        .game-item.incorrect {
            background-color: var(--incorrect-color);
            color: white;
            border-color: var(--incorrect-color);
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .feedback {
            text-align: center;
            font-weight: bold;
            min-height: 20px;
            margin-top: 10px;
            transition: opacity 0.3s;
            font-size: 0.9em;
        }

        .feedback.correct {
            color: var(--correct-color);
        }

        .feedback.incorrect {
            color: var(--incorrect-color);
        }

        /* --- Drag and Drop Game Styles --- */
        .drag-drop-game {
            margin-top: 20px;
            border: 1px dashed var(--primary-color);
            padding: 20px;
            border-radius: 5px;
        }

        .drag-drop-game h3 {
            color: var(--primary-color);
            text-align: center;
            margin-top: 0;
        }

        .drag-container {
            background-color: rgba(0,255,204,0.1);
            border: 1px solid var(--primary-color);
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        .draggable {
            background-color: var(--bg-color);
            border: 1px solid var(--text-color);
            color: var(--text-color);
            padding: 8px 12px;
            margin: 5px;
            border-radius: 5px;
            cursor: move;
            transition: opacity 0.3s;
            font-size: 0.9em;
        }

        .draggable:hover {
            opacity: 0.7;
        }

        .draggable.dragging {
            opacity: 0.5;
        }

        .drop-zones {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .drop-zone {
            background-color: var(--bg-color);
            border: 2px dashed var(--primary-color);
            padding: 15px;
            min-height: 60px;
            border-radius: 5px;
            transition: background-color 0.3s, border-color 0.3s;
        }

        .drop-zone.drag-over {
            background-color: rgba(0, 255, 204, 0.2);
            border-color: var(--primary-color);
            border-style: solid;
        }

        .drop-zone h4 {
            font-family: var(--font-heading);
            color: var(--primary-color);
            margin-top: 0;
            margin-bottom: 10px;
            text-align: center;
        }

        .drop-zone .draggable {
            margin: 0 0 8px 0;
        }

        .drop-zone .draggable.correct {
            background-color: var(--correct-color);
            color: white;
            border-color: var(--correct-color);
            cursor: default;
        }
        
        .drop-zone .draggable.incorrect {
            animation: shake 0.5s;
        }

        /* --- TEEL Connector Practice Styles --- */
        .connector-practice {
            margin-top: 20px;
            border: 1px dashed var(--primary-color);
            padding: 20px;
            border-radius: 5px;
        }

        .connector-practice h3 {
            color: var(--primary-color);
            text-align: center;
            margin-top: 0;
        }

        .connector-item {
            margin-bottom: 20px;
            background-color: rgba(0, 255, 204, 0.03);
            border-radius: 5px;
            padding: 15px;
        }

        .connector-item p {
            font-size: 0.9em;
            margin: 4px 0;
        }

        .connector-label {
            font-weight: 700;
        }

        .connector-starters {
            font-size: 0.85em;
            font-style: italic;
            margin-top: 5px;
            margin-bottom: 8px;
        }

        .connector-item textarea {
            margin-top: 8px;
            margin-bottom: 8px;
        }

        .example-text {
            font-size: 0.85em;
            font-style: italic;
            background-color: rgba(0, 255, 204, 0.1);
            border-left: 3px solid var(--primary-color);
            padding: 8px;
            border-radius: 3px;
            display: none;
        }

        .connector-practice button.reveal-example {
            font-size: 0.8em;
            padding: 5px 10px;
            margin-top: 0;
        }

        .small-note {
            font-size: 0.85em;
            text-align: center;
            margin-top: 8px;
            color: #cfd8dc;
        }

        #wordCount {
            font-size: 0.85em;
            margin-top: 5px;
            text-align: right;
            color: #cfd8dc;
        }

        #copyMessage {
            font-size: 0.85em;
            text-align: center;
            margin-top: 8px;
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- ======================= PHASE 1: TRAINING ACADEMY ======================= -->
        <div class="training" id="training">
            <h1>TEEL TRAINING ACADEMY</h1>
            <p class="intro-text">
                Welcome, Agent. In this Training Academy you will learn how to write a strong TEEL paragraph. 
                When you are confident, you will use TEEL to explain your <em>Two Wolves</em> Bento Box.
            </p>

            <h2>What is TEEL?</h2>
            <p>
                TEEL is a way to build a clear paragraph. It helps you keep your ideas in order so your reader can understand your thinking.
                TEEL stands for:
            </p>
            
            <div class="teel-breakdown">
                <div class="teel-part">
                    <h3>T ‚Äì Topic Sentence</h3>
                    <p>The main idea of your paragraph. It tells the reader what your paragraph will be about.</p>
                    <p class="common-words"><strong>Common Words:</strong> One important idea is..., The main point is..., This paragraph will explain...</p>
                    <p class="example"><strong>Example from <em>Two Wolves</em>:</strong> "Ben must decide whether to protect his father or tell the truth about what he has done."</p>
                </div>
                <div class="teel-part">
                    <h3>E ‚Äì Evidence</h3>
                    <p>Proof from the text. This is a quote or a clear description of a moment in the story.</p>
                    <p class="common-words"><strong>Common Words:</strong> For example..., The novel states..., When Ben says...</p>
                    <p class="example"><strong>Example:</strong> "For example, on page 76 the novel states, 'I know what Dad is doing is wrong, but I still want to believe him.'"</p>
                </div>
                <div class="teel-part">
                    <h3>E ‚Äì Explanation</h3>
                    <p>Your thinking. You explain how your evidence supports your topic sentence.</p>
                    <p class="common-words"><strong>Common Words:</strong> This shows that..., This means..., This helps the reader see...</p>
                    <p class="example"><strong>Example:</strong> "This shows that Ben is torn between doing the right thing and staying loyal to his father."</p>
                </div>
                <div class="teel-part">
                    <h3>L ‚Äì Link</h3>
                    <p>The closing idea. You link back to the topic sentence or to a bigger idea in the story.</p>
                    <p class="common-words"><strong>Common Words:</strong> Overall..., As a result..., This proves that...</p>
                    <p class="example"><strong>Example:</strong> "Overall, this proves that Ben's biggest challenge in the story is choosing between honesty and loyalty."</p>
                </div>
            </div>

            <!-- Container for all training tasks in scaffolded order -->
            <div id="training-tasks-container">

                <!-- Training Task 1: Match the Word (game2) -->
                <div class="matching-game" id="game2">
                    <h3>Training Task 1: Match the Phrases</h3>
                    <p>Click on a phrase on the left, then click on the TEEL part where it would most likely be used.</p>
                    <div class="game-items">
                        <div class="column">
                            <div class="game-item" data-answer="T">One important idea is...</div>
                            <div class="game-item" data-answer="E">For example...</div>
                            <div class="game-item" data-answer="E">The novel states...</div>
                            <div class="game-item" data-answer="L">Overall...</div>
                        </div>
                        <div class="column">
                            <div class="game-item" data-choice="T">Topic Sentence</div>
                            <div class="game-item" data-choice="E">Evidence</div>
                            <div class="game-item" data-choice="E">Explanation</div>
                            <div class="game-item" data-choice="L">Link</div>
                        </div>
                    </div>
                    <div class="feedback" id="feedback2"></div>
                </div>

                <!-- Training Task 2: Identify the Job (game5) -->
                <div class="matching-game" id="game5">
                    <h3>Training Task 2: Match the Job</h3>
                    <p>Match the job of each sentence to the TEEL part that does that job.</p>
                    <div class="game-items">
                        <div class="column">
                            <div class="game-item" data-answer="T">This sentence tells the main point of the paragraph.</div>
                            <div class="game-item" data-answer="E">This sentence explains the idea in more detail.</div>
                            <div class="game-item" data-answer="E">This sentence uses a quote from the text.</div>
                            <div class="game-item" data-answer="L">This sentence finishes the idea and links back to the main point.</div>
                        </div>
                        <div class="column">
                            <div class="game-item" data-choice="T">Topic Sentence</div>
                            <div class="game-item" data-choice="E">Evidence</div>
                            <div class="game-item" data-choice="E">Explanation</div>
                            <div class="game-item" data-choice="L">Link</div>
                        </div>
                    </div>
                    <div class="feedback" id="feedback5"></div>
                </div>

                <!-- Training Task 3: Match the Sentence (game1) -->
                <div class="matching-game" id="game1">
                    <h3>Training Task 3: Match the Sentences</h3>
                    <p>Click on a sentence on the left, then click on its correct TEEL part on the right.</p>
                    <div class="game-items">
                        <div class="column">
                            <div class="game-item" data-answer="T">Dogs make excellent pets for many families.</div>
                            <div class="game-item" data-answer="E">They provide companionship and encourage owners to exercise.</div>
                            <div class="game-item" data-answer="E">For instance, a study showed that dog owners are 30% more likely to meet daily exercise guidelines.</div>
                            <div class="game-item" data-answer="L">Therefore, owning a dog can help a family stay happy and healthy.</div>
                        </div>
                        <div class="column">
                            <div class="game-item" data-choice="T">Topic Sentence</div>
                            <div class="game-item" data-choice="E">Evidence</div>
                            <div class="game-item" data-choice="E">Explanation</div>
                            <div class="game-item" data-choice="L">Link</div>
                        </div>
                    </div>
                    <div class="feedback" id="feedback1"></div>
                </div>

                <!-- Training Task 4: Sort the Paragraph (game3) -->
                <div class="drag-drop-game" id="game3">
                    <h3>Training Task 4: Sort the Paragraph</h3>
                    <p>Drag each sentence into the correct TEEL box to build a paragraph.</p>
                    
                    <div class="drag-container" id="dragSource">
                        <div class="draggable" draggable="true" data-teel="E">For example, a cat will happily sleep on a windowsill all day while its owner is at work, whereas a dog might chew furniture out of boredom.</div>
                        <div class="draggable" draggable="true" data-teel="L">Therefore, for people with busy lifestyles, a cat offers a more practical and low-maintenance pet.</div>
                        <div class="draggable" draggable="true" data-teel="T">Cats are often better indoor pets than dogs because they are more independent.</div>
                        <div class="draggable" draggable="true" data-teel="E">This independence means they do not suffer from separation anxiety as much as dogs and are happy to be alone.</div>
                    </div>

                    <div class="drop-zones">
                        <div class="drop-zone" data-teel="T">
                            <h4>T ‚Äì Topic Sentence</h4>
                        </div>
                        <div class="drop-zone" data-teel="E">
                            <h4>E ‚Äì Evidence</h4>
                        </div>
                        <div class="drop-zone" data-teel="E">
                            <h4>E ‚Äì Explanation</h4>
                        </div>
                        <div class="drop-zone" data-teel="L">
                            <h4>L ‚Äì Link</h4>
                        </div>
                    </div>
                    <div class="feedback" id="feedback3"></div>
                </div>

                <!-- Training Task 5: Match the Quote (game4) -->
                <div class="matching-game" id="game4">
                    <h3>Training Task 5: Match the Quote</h3>
                    <p>Match each sentence with the TEEL part it could belong to in a paragraph about <em>Two Wolves</em>.</p>
                    <div class="game-items">
                        <div class="column">
                            <div class="game-item" data-answer="T">Ben‚Äôs biggest problem in the story is deciding who he can trust.</div>
                            <div class="game-item" data-answer="E">‚ÄúI know what Dad is doing is wrong, but I still want to believe him.‚Äù</div>
                            <div class="game-item" data-answer="E">This shows that Ben feels pulled in two directions and is scared to accept the truth.</div>
                            <div class="game-item" data-answer="L">Overall, this proves that trust and doubt are central ideas in Ben‚Äôs journey.</div>
                        </div>
                        <div class="column">
                            <div class="game-item" data-choice="T">Topic Sentence</div>
                            <div class="game-item" data-choice="E">Evidence</div>
                            <div class="game-item" data-choice="E">Explanation</div>
                            <div class="game-item" data-choice="L">Link</div>
                        </div>
                    </div>
                    <div class="feedback" id="feedback4"></div>
                </div>

                <!-- Training Task 6: TEEL Connector Practice -->
                <div class="connector-practice" id="connectorPractice">
                    <h3>Training Task 6: TEEL Connector Practice</h3>
                    <p class="small-note">
                        For each example, the Topic Sentence (T) and Evidence (E) are given. 
                        Your mission: write ONE Explanation sentence that clearly connects the Evidence back to the Topic Sentence.
                    </p>

                    <!-- Item 1 -->
                    <div class="connector-item">
                        <p class="connector-label">Topic Sentence (T):</p>
                        <p>Ben must choose between protecting his dad and doing the right thing.</p>

                        <p class="connector-label">Evidence (E):</p>
                        <p>‚ÄúI know what Dad is doing is wrong, but I still want to believe him.‚Äù</p>

                        <p class="connector-starters">
                            Think: How does this quote show what Ben is feeling about this decision?
                        </p>

                        <textarea 
                            placeholder="Write ONE Explanation sentence that connects the quote to Ben‚Äôs difficult choice..."></textarea>

                        <button class="reveal-example" data-example-id="connectorEx1">SHOW EXAMPLE EXPLANATION</button>
                        <p id="connectorEx1" class="example-text">
                            Example: This quote shows that Ben feels torn between the truth and his loyalty to his dad, making his decision very stressful and confusing.
                        </p>
                    </div>

                    <!-- Item 2 -->
                    <div class="connector-item">
                        <p class="connector-label">Topic Sentence (T):</p>
                        <p>The Australian bush setting makes Ben feel both excited and scared.</p>

                        <p class="connector-label">Evidence (E):</p>
                        <p>‚ÄúEvery shadow looked like something waiting to move.‚Äù</p>

                        <p class="connector-starters">
                            Think: What does this quote suggest about how the setting feels to Ben?
                        </p>

                        <textarea 
                            placeholder="Write ONE Explanation sentence that connects the quote to how the setting feels for Ben..."></textarea>

                        <button class="reveal-example" data-example-id="connectorEx2">SHOW EXAMPLE EXPLANATION</button>
                        <p id="connectorEx2" class="example-text">
                            Example: This shows that Ben feels nervous in the bush, as if danger might appear at any moment, which makes the setting feel unsafe as well as exciting.
                        </p>
                    </div>

                    <!-- Item 3 -->
                    <div class="connector-item">
                        <p class="connector-label">Topic Sentence (T):</p>
                        <p>In <em>Two Wolves</em>, family loyalty sometimes causes problems for Ben.</p>

                        <p class="connector-label">Evidence (E):</p>
                        <p>‚ÄúI knew what Dad was doing was wrong, but I still wanted to go with him.‚Äù</p>

                        <p class="connector-starters">
                            Think: How does this line show that loyalty can be a problem for Ben?
                        </p>

                        <textarea 
                            placeholder="Write ONE Explanation sentence that connects the quote to the idea that loyalty can be negative..."></textarea>

                        <button class="reveal-example" data-example-id="connectorEx3">SHOW EXAMPLE EXPLANATION</button>
                        <p id="connectorEx3" class="example-text">
                            Example: This proves that Ben‚Äôs loyalty to his dad pulls him into risky situations, showing that family loyalty can sometimes stop him from making safe choices.
                        </p>
                    </div>

                    <p class="small-note">
                        Tip: If your Explanation clearly answers ‚ÄúHow does this quote prove my Topic Sentence?‚Äù, you have built a strong TEEL connection.
                    </p>
                </div>

            </div> <!-- End of training-tasks-container -->

            <div class="button-row">
                <button id="startFieldMissionBtn" disabled class="main-btn">START FIELD MISSION</button>
            </div>
        </div>

        <!-- ======================= PHASE 2: FIELD MISSION ‚Äì BENTO BOX PARAGRAPH ======================= -->
        <div class="mission" id="mission" style="display: none;">
            <h1>TEEL MISSION: BENTO BOX PARAGRAPH</h1>
            <p class="intro-text">
                Great work, Agent. You have trained with TEEL. Now it is time to write your real paragraph.
                In this mission you will write ONE TEEL paragraph to explain how your Bento Box items show a theme from <em>Two Wolves</em>.
            </p>

            <!-- SECTION 1: CHOOSE / WRITE THEME -->
            <div id="objective-section" class="mission-section visible">
                <h2>Step 1: Your Theme</h2>
                <p>
                    First, choose the theme or big idea from <em>Two Wolves</em> that your Bento Box is about.
                    Write it in the box below.
                </p>
                <div class="objectives">
                    <p><strong>Examples of themes you might choose:</strong></p>
                    <ul>
                        <li>Family loyalty</li>
                        <li>Honesty and truth</li>
                        <li>Trust and betrayal</li>
                        <li>Facing fear</li>
                        <li>Right and wrong choices</li>
                    </ul>
                    <label>
                        <span>Your theme:</span><br>
                        <input type="text" id="themeInput" style="width:100%; margin-top:5px; padding:8px; border-radius:5px; border:1px solid var(--secondary-color); background-color:var(--bg-color); color:var(--text-color);">
                    </label>
                </div>
                <div class="button-row">
                    <button id="startMissionBtn" disabled class="main-btn">START TEEL PARAGRAPH</button>
                </div>
            </div>

            <!-- SECTION 2: T-LOCK -->
            <div id="t-lock-section" class="mission-section">
                <h2>Step 2: T ‚Äì Topic Sentence</h2>
                <div class="lock-box">
                    <h3>T is for TOPIC SENTENCE</h3>
                    <p><strong>What it does:</strong> Says your main idea in one clear sentence. It must name your theme and say that your Bento Box items show this theme.</p>
                    <p><strong>Ask yourself:</strong></p>
                    <ul>
                        <li>What theme did I choose?</li>
                        <li>How do my items help show this theme in the story?</li>
                    </ul>
                    <p><strong>Tip:</strong> In one sentence, say your theme and tell the reader that your items represent parts of this theme in <em>Two Wolves</em>.</p>
                    <p><strong>Example (about loyalty):</strong> "My Bento Box shows the theme of family loyalty in <em>Two Wolves</em>, because each item represents a moment when Ben must decide whether to stand by his family or do the right thing."</p>
                </div>
                <textarea id="t-text" placeholder="Type your Topic Sentence here..."></textarea>
                <div class="button-row">
                    <button id="unlockE2Btn" disabled class="main-btn">NEXT: E ‚Äì EVIDENCE</button>
                </div>
            </div>

            <!-- SECTION 3: E-LOCK 1 (Evidence) -->
            <div id="e2-lock-section" class="mission-section">
                <h2>Step 3: E ‚Äì Evidence</h2>
                <div class="lock-box">
                    <h3>E is for EVIDENCE</h3>
                    <p><strong>What it does:</strong> Gives a strong quote or a clear description from the book. This proves that your theme is important in the story.</p>
                    <p><strong>Ask yourself:</strong></p>
                    <ul>
                        <li>Which moment or quote from the book matches my theme and my items?</li>
                        <li>Can I include a page number to show where it is?</li>
                    </ul>
                    <p><strong>Tip:</strong> Choose one moment that connects well to your theme and at least one of your items.</p>
                    <p><strong>Example:</strong> "For example, on page 76 the novel states, 'I know what Dad is doing is wrong, but I still want to believe him,' which shows Ben‚Äôs struggle between truth and loyalty."</p>
                </div>
                <textarea id="e2-text" placeholder="Type your Evidence (with quotation marks and page number) here..."></textarea>
                <div class="button-row">
                    <button id="unlockE1Btn" disabled class="main-btn">NEXT: E ‚Äì EXPLANATION</button>
                </div>
            </div>

            <!-- SECTION 4: E-LOCK 2 (Explanation) -->
            <div id="e1-lock-section" class="mission-section">
                <h2>Step 4: E ‚Äì Explanation</h2>
                <div class="lock-box">
                    <h3>E is for EXPLANATION</h3>
                    <p><strong>What it does:</strong> Explains how your evidence and your Bento Box items show the theme. This is your thinking in your own words.</p>
                    <p><strong>Ask yourself:</strong></p>
                    <ul>
                        <li>How does my quote or scene show this theme?</li>
                        <li>How do my items match this moment or idea?</li>
                    </ul>
                    <p><strong>Tip:</strong> Try to name at least one or two items and explain how they link to the theme and the evidence.</p>
                    <p><strong>Example:</strong> "This shows Ben is torn between doing the right thing and staying loyal to his father, just like the broken compass in my Bento Box, which represents how he feels lost about which direction to choose."</p>
                </div>
                <textarea id="e1-text" placeholder="Type your Explanation here..."></textarea>
                <div class="button-row">
                    <button id="unlockLBtn" disabled class="main-btn">NEXT: L ‚Äì LINK</button>
                </div>
            </div>

            <!-- SECTION 5: L-LOCK -->
            <div id="l-lock-section" class="mission-section">
                <h2>Step 5: L ‚Äì Link</h2>
                <div class="lock-box">
                    <h3>L is for LINK</h3>
                    <p><strong>What it does:</strong> Finishes your paragraph. It links back to your theme and shows why your items and this idea are important in <em>Two Wolves</em>.</p>
                    <p><strong>Ask yourself:</strong></p>
                    <ul>
                        <li>What do all my items show when we look at them together?</li>
                        <li>Why is this theme important in the story?</li>
                    </ul>
                    <p><strong>Tip:</strong> Zoom out. Think about the whole book, not just one scene.</p>
                    <p><strong>Example:</strong> "Overall, these items show that family loyalty both helps and hurts Ben, proving that this theme is one of the most important ideas in <em>Two Wolves</em>."</p>
                </div>
                <textarea id="l-text" placeholder="Type your Linking sentence here..."></textarea>
                <div class="button-row">
                    <button id="assembleBtn" disabled class="main-btn">ASSEMBLE PARAGRAPH</button>
                </div>
            </div>
            
            <!-- SECTION 6: ASSEMBLE PARAGRAPH -->
            <div id="assemble-section" class="mission-section">
                <h2>Step 6: Your Full TEEL Paragraph</h2>
                <p>
                    Your paragraph has been built using your T, E, E and L. 
                    Read it carefully. You can edit and improve it in the box below.
                </p>
                <textarea id="finalParagraph"></textarea>
                <p id="wordCount">Word count: 0</p>
                <button id="clearWorkBtn" style="background:none;color:#ff6b9d;border:1px dashed #ff6b9d;font-size:0.8em;margin-top:10px;">
                    Clear My Saved Work (Teacher Testing)
                </button>
                <div class="button-row">
                    <button id="debriefBtn" class="main-btn">NEXT: SELF-CHECK</button>
                </div>
            </div>

            <!-- SECTION 7: DEBRIEF + HAND IN -->
            <div id="debrief-section" class="mission-section">
                <h2>Step 7: Self-Check and Hand In</h2>
                <p>Use this checklist to check your paragraph before you hand it in.</p>
                <ul class="checklist">
                    <li><input type="checkbox" id="check1"><label for="check1"> My paragraph starts with a clear Topic Sentence that names my theme and mentions my Bento Box.</label></li>
                    <li><input type="checkbox" id="check2"><label for="check2"> I have included Evidence from the novel (a quote or a clear scene) with a page number if possible.</label></li>
                    <li><input type="checkbox" id="check3"><label for="check3"> I have explained how my evidence and items connect to the theme.</label></li>
                    <li><input type="checkbox" id="check4"><label for="check4"> My last sentence links back to the theme and the story as a whole.</label></li>
                </ul>

                <h3 style="margin-top:20px;">Hand In Your Paragraph</h3>
                <p style="font-size:0.9em;">
                    When your checklist is complete, use one of these options to hand in your work (follow your teacher‚Äôs instructions):
                </p>
                <ul class="checklist">
                    <li>Click <strong>Copy Paragraph</strong> and paste it into our class assignment page.</li>
                    <li>Or click <strong>Download Paragraph</strong> and upload the file where your teacher has asked.</li>
                </ul>

                <div class="button-row">
                    <button id="copyBtn">COPY PARAGRAPH</button>
                    <button id="downloadBtn">DOWNLOAD PARAGRAPH</button>
                    <button id="completeMissionBtn" class="main-btn">COMPLETE MISSION</button>
                </div>
                <p id="copyMessage"></p>

                <div id="congratsMessage">
                    üéâ MISSION ACCOMPLISHED! üéâ
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- TRAINING ACADEMY LOGIC ---
        const trainingSection = document.getElementById('training');
        const missionSection = document.getElementById('mission');
        const startFieldMissionBtn = document.getElementById('startFieldMissionBtn');

        let game1Complete = false;
        let game2Complete = false;
        let game3Complete = false;
        let game4Complete = false;
        let game5Complete = false;

        function enableMissionStart() {
            if (game1Complete && game2Complete && game3Complete && game4Complete && game5Complete) {
                startFieldMissionBtn.disabled = false;
                startFieldMissionBtn.textContent = "TRAINING COMPLETE ‚Äì START FIELD MISSION";
            }
        }

        // --- Game 1, 2, 4, 5 Logic (Matching) ---
        function setupGame(gameId) {
            const gameItems = document.querySelectorAll(`#${gameId} .game-item`);
            const feedbackDiv = document.getElementById(`feedback${gameId.slice(-1)}`);
            let firstSelection = null;
            let correctMatches = 0;
            let isProcessing = false;

            gameItems.forEach(item => {
                item.addEventListener('click', () => {
                    if (isProcessing || item.classList.contains('correct')) return;

                    if (!firstSelection) {
                        firstSelection = item;
                        item.classList.add('selected');
                    } else {
                        if (firstSelection === item) {
                            item.classList.remove('selected');
                            firstSelection = null;
                            return;
                        }
                        
                        isProcessing = true;
                        const isCorrect = firstSelection.dataset.answer === item.dataset.choice;

                        if (isCorrect) {
                            firstSelection.classList.remove('selected');
                            item.classList.remove('selected');
                            firstSelection.classList.add('correct');
                            item.classList.add('correct');
                            correctMatches++;

                            feedbackDiv.textContent = "Correct match!";
                            feedbackDiv.className = 'feedback correct';
                            setTimeout(() => {
                                feedbackDiv.textContent = '';
                                feedbackDiv.className = 'feedback';
                                isProcessing = false;
                                if (correctMatches === 4) {
                                    switch (gameId) {
                                        case 'game1': game1Complete = true; break;
                                        case 'game2': game2Complete = true; break;
                                        case 'game4': game4Complete = true; break;
                                        case 'game5': game5Complete = true; break;
                                    }
                                    enableMissionStart();
                                }
                            }, 800);
                        } else {
                            firstSelection.classList.add('incorrect');
                            item.classList.add('incorrect');
                            feedbackDiv.textContent = "Incorrect. Try again.";
                            feedbackDiv.className = 'feedback incorrect';

                            const firstSelectionCopy = firstSelection;
                            const itemCopy = item;
                            const feedbackDivCopy = feedbackDiv;

                            setTimeout(() => {
                                firstSelectionCopy.classList.remove('selected', 'incorrect');
                                itemCopy.classList.remove('incorrect');
                                feedbackDivCopy.textContent = '';
                                feedbackDivCopy.className = 'feedback';
                                isProcessing = false;
                            }, 1200);
                        }
                        firstSelection = null;
                    }
                });
            });
        }

        // Set up matching games
        setupGame('game1');
        setupGame('game2');
        setupGame('game4');
        setupGame('game5');

        // --- Game 3 Logic (Drag and Drop) ---
        const draggables = document.querySelectorAll('#game3 .draggable');
        const dropZones = document.querySelectorAll('#game3 .drop-zone');
        const feedback3 = document.getElementById('feedback3');
        let correctDrops = 0;

        draggables.forEach(draggable => {
            draggable.addEventListener('dragstart', () => {
                draggable.classList.add('dragging');
            });

            draggable.addEventListener('dragend', () => {
                draggable.classList.remove('dragging');
            });
        });

        dropZones.forEach(zone => {
            zone.addEventListener('dragover', e => {
                e.preventDefault();
                zone.classList.add('drag-over');
            });

            zone.addEventListener('dragleave', () => {
                zone.classList.remove('drag-over');
            });

            zone.addEventListener('drop', e => {
                e.preventDefault();
                zone.classList.remove('drag-over');
                
                const draggable = document.querySelector('.dragging');
                if (!draggable) return;

                if (zone.querySelector('.draggable')) {
                    feedback3.textContent = "This spot is already filled.";
                    feedback3.className = 'feedback incorrect';
                    setTimeout(() => { feedback3.textContent = ''; feedback3.className='feedback'; }, 1200);
                    return;
                }

                const isCorrect = draggable.dataset.teel === zone.dataset.teel;
                zone.appendChild(draggable);

                if (isCorrect) {
                    draggable.classList.add('correct');
                    draggable.draggable = false;
                    correctDrops++;
                    feedback3.textContent = "Correct placement!";
                    feedback3.className = 'feedback correct';
                    setTimeout(() => { feedback3.textContent = ''; feedback3.className='feedback'; }, 800);

                    if (correctDrops === 4) {
                        game3Complete = true;
                        enableMissionStart();
                    }
                } else {
                    draggable.classList.add('incorrect');
                    feedback3.textContent = "Incorrect placement. Try again.";
                    feedback3.className = 'feedback incorrect';
                    setTimeout(() => {
                        draggable.classList.remove('incorrect');
                        document.getElementById('dragSource').appendChild(draggable);
                        feedback3.textContent = '';
                        feedback3.className='feedback';
                    }, 1200);
                }
            });
        });

        // --- TEEL Connector Practice: Show/Hide Example Explanations ---
        document.querySelectorAll('.reveal-example').forEach(button => {
            button.addEventListener('click', () => {
                const exampleId = button.getAttribute('data-example-id');
                const exampleEl = document.getElementById(exampleId);
                if (!exampleEl) return;

                const isHidden = exampleEl.style.display === '' || exampleEl.style.display === 'none';

                if (isHidden) {
                    exampleEl.style.display = 'block';
                    button.textContent = 'HIDE EXAMPLE EXPLANATION';
                } else {
                    exampleEl.style.display = 'none';
                    button.textContent = 'SHOW EXAMPLE EXPLANATION';
                }
            });
        });

        // --- Transition to Mission ---
        startFieldMissionBtn.addEventListener('click', () => {
            trainingSection.style.display = 'none';
            missionSection.style.display = 'block';
            missionSection.scrollIntoView({ behavior: 'smooth' });
        });

        // --- MISSION LOGIC ---
        const themeInput = document.getElementById('themeInput');
        const objectiveSection = document.getElementById('objective-section');
        const tLockSection = document.getElementById('t-lock-section');
        const e2LockSection = document.getElementById('e2-lock-section');
        const e1LockSection = document.getElementById('e1-lock-section');
        const lLockSection = document.getElementById('l-lock-section');
        const assembleSection = document.getElementById('assemble-section');
        const debriefSection = document.getElementById('debrief-section');

        const startMissionBtn = document.getElementById('startMissionBtn');
        const unlockE2Btn = document.getElementById('unlockE2Btn');
        const unlockE1Btn = document.getElementById('unlockE1Btn');
        const unlockLBtn = document.getElementById('unlockLBtn');
        const assembleBtn = document.getElementById('assembleBtn');
        const debriefBtn = document.getElementById('debriefBtn');
        const completeMissionBtn = document.getElementById('completeMissionBtn');
        const copyBtn = document.getElementById('copyBtn');
        const downloadBtn = document.getElementById('downloadBtn');

        const tText = document.getElementById('t-text');
        const e2Text = document.getElementById('e2-text');
        const e1Text = document.getElementById('e1-text');
        const lText = document.getElementById('l-text');
        const finalParagraph = document.getElementById('finalParagraph');
        const wordCountEl = document.getElementById('wordCount');
        const copyMessage = document.getElementById('copyMessage');
        const congratsMessage = document.getElementById('congratsMessage');

        // ================= AUTOSAVE SYSTEM =================

        // Map field IDs to storage keys
        const autosaveMap = {
            themeInput: 'tw-theme',
            't-text': 'tw-t',
            'e2-text': 'tw-e2',
            'e1-text': 'tw-e1',
            'l-text': 'tw-l',
            finalParagraph: 'tw-final'
        };

        // Restore saved values on load
        for (const [id, key] of Object.entries(autosaveMap)) {
            const el = document.getElementById(id);
            if (el && localStorage.getItem(key)) {
                el.value = localStorage.getItem(key);
            }
        }

        // Update button states after restore
        if (themeInput.value.trim() !== '') {
            startMissionBtn.disabled = false;
        }
        if (tText.value.trim() !== '') {
            unlockE2Btn.disabled = false;
        }
        if (e2Text.value.trim() !== '') {
            unlockE1Btn.disabled = false;
        }
        if (e1Text.value.trim() !== '') {
            unlockLBtn.disabled = false;
        }
        if (lText.value.trim() !== '') {
            assembleBtn.disabled = false;
        }

        // Autosave on input
        for (const [id, key] of Object.entries(autosaveMap)) {
            const el = document.getElementById(id);
            if (el) {
                el.addEventListener('input', () => {
                    localStorage.setItem(key, el.value);
                });
            }
        }

        // Clear saved work button
        const clearBtn = document.getElementById('clearWorkBtn');
        if (clearBtn) {
            clearBtn.addEventListener('click', () => {
                if (confirm('Clear all saved student work?')) {
                    for (const key of Object.values(autosaveMap)) {
                        localStorage.removeItem(key);
                    }
                    location.reload();
                }
            });
        }

        // Update word count after restore if finalParagraph has content
        if (finalParagraph.value.trim() !== '') {
            updateWordCount();
        }

        function showSection(section) {
            section.classList.add('visible');
        }

        // Theme input enables Start Mission
        themeInput.addEventListener('input', () => {
            startMissionBtn.disabled = themeInput.value.trim() === '';
        });

        startMissionBtn.addEventListener('click', () => {
            showSection(tLockSection);
            tLockSection.scrollIntoView({ behavior: 'smooth' });
        });

        tText.addEventListener('input', () => {
            unlockE2Btn.disabled = tText.value.trim() === '';
        });

        unlockE2Btn.addEventListener('click', () => {
            showSection(e2LockSection);
            e2LockSection.scrollIntoView({ behavior: 'smooth' });
        });

        e2Text.addEventListener('input', () => {
            unlockE1Btn.disabled = e2Text.value.trim() === '';
        });

        unlockE1Btn.addEventListener('click', () => {
            showSection(e1LockSection);
            e1LockSection.scrollIntoView({ behavior: 'smooth' });
        });

        e1Text.addEventListener('input', () => {
            unlockLBtn.disabled = e1Text.value.trim() === '';
        });

        unlockLBtn.addEventListener('click', () => {
            showSection(lLockSection);
            lLockSection.scrollIntoView({ behavior: 'smooth' });
        });

        lText.addEventListener('input', () => {
            assembleBtn.disabled = lText.value.trim() === '';
        });

        function updateWordCount() {
            const text = finalParagraph.value.trim();
            if (text === '') {
                wordCountEl.textContent = 'Word count: 0';
                return;
            }
            const words = text.split(/\s+/).filter(Boolean);
            wordCountEl.textContent = 'Word count: ' + words.length;
        }

        finalParagraph.addEventListener('input', updateWordCount);

        assembleBtn.addEventListener('click', () => {
            // T-E-E-L Assembly Order
            let paragraph = `${tText.value.trim()} ${e2Text.value.trim()} ${e1Text.value.trim()} ${lText.value.trim()}`;
            finalParagraph.value = paragraph.trim();
            updateWordCount();
            showSection(assembleSection);
            assembleSection.scrollIntoView({ behavior: 'smooth' });
        });
        
        debriefBtn.addEventListener('click', () => {
            showSection(debriefSection);
            debriefSection.scrollIntoView({ behavior: 'smooth' });
        });

        // Copy paragraph to clipboard
        copyBtn.addEventListener('click', async () => {
            const text = finalParagraph.value.trim();
            if (!text) {
                copyMessage.textContent = 'Please write your paragraph before copying.';
                copyMessage.style.color = '#ff6b9d';
                return;
            }
            try {
                await navigator.clipboard.writeText(text);
                copyMessage.textContent = 'Paragraph copied. Paste it into the place your teacher has asked.';
                copyMessage.style.color = '#00ffcc';
            } catch (err) {
                copyMessage.textContent = 'Copy did not work. Please select and copy the text yourself.';
                copyMessage.style.color = '#ff6b9d';
            }
        });

        // Download paragraph as .txt file
        downloadBtn.addEventListener('click', () => {
            const text = finalParagraph.value.trim();
            if (!text) {
                copyMessage.textContent = 'Please write your paragraph before downloading.';
                copyMessage.style.color = '#ff6b9d';
                return;
            }

            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'two-wolves-bento-paragraph.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            copyMessage.textContent = 'File downloaded. Upload it where your teacher has asked.';
            copyMessage.style.color = '#00ffcc';
        });

        // Complete mission
        completeMissionBtn.addEventListener('click', () => {
            const check1 = document.getElementById('check1').checked;
            const check2 = document.getElementById('check2').checked;
            const check3 = document.getElementById('check3').checked;
            const check4 = document.getElementById('check4').checked;

            if (check1 && check2 && check3 && check4) {
                congratsMessage.style.display = 'block';
            } else {
                alert('Agent, please finish all parts of the checklist before you complete the mission.');
            }
        });
    </script>
</body>
</html>
